1)
USE sakila;
SELECT 
  CONCAT(sf.first_name, ' ', sf.last_name) AS manager,
  ct.city,
  COUNT(c.customer_id) AS customer_count 
FROM customer c
JOIN staff sf ON c.store_id = sf.store_id
JOIN store sr ON c.store_id = sr.store_id
JOIN address addr ON sr.address_id = addr.address_id
JOIN city ct ON ct.city_id = addr.city_id
GROUP BY c.store_id,  sf.first_name, sf.last_name
HAVING COUNT(c.customer_id) > 300;

2)
USE sakila;
SELECT COUNT(length)
FROM film
WHERE length > (SELECT AVG(length) from film)

3)
USE sakila;
SELECT SUM(amount) AS total_sum, MONTH(payment_date) AS payment_month
FROM payment
GROUP BY MONTH(payment_date)
ORDER BY SUM(amount) DESC LIMIT 1;